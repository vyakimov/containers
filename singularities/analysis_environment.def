bootstrap: docker
from: viya/biodocker

%post
  cd /opt && git clone https://github.com/pezmaster31/bamtools.git &&\
  cd bamtools && git checkout d24d850de17134fe4e7984b26493c5c0a1844b35 &&\
  mkdir build && cd build &&\
  cmake -DCMAKE_INSTALL_PREFIX=/usr/ .. && make && make install &&\
  cd /opt && git clone https://github.com/PMBio/peer.git &&\
  cd peer && mkdir build && cd build &&\
  cmake ./.. && make && make install &&\
  cd $HOME && rm -rf /opt/* &&\
  R --slave -e 'install.packages(c("plyr", "knitr", "kableExtra", "gridExtra", "lmtest", "ggbeeswarm", "wesanderson", "lme4", "statmod", "parallelly"), dependencies=TRUE, repos="http://cran.rstudio.com/", lib="/usr/lib/R/library")' 
  R --slave  -e 'BiocManager::install(c("ensembldb", "variancePartition", "sva", "WGCNA", "goseq", "DESeq2", "biomaRt", "tximportData", "GenomicFeatures", "EnsDb.Hsapiens.v75", "tximport", "sva", "FDb.UCSC.tRNAs", "preprocessCore", "qvalue", "edgeR"), update=TRUE, lib="/usr/lib/R/library")' 
  R --slave -e 'remotes::install_github("vqv/ggbiplot", lib="/usr/lib/R/library")' 
%environment
  export LCALL=en_US.UTF-8
  export LANG=en_US.UTF-8
  export R_LIBS_SITE=/usr/lib/R/library:/usr/local/lib/R/site-library:/usr/lib/R/site-library
